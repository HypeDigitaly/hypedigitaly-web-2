---
import PageLayout from '../layouts/PageLayout.astro';
import AuditRoadmapAnimated from '../components/sections/AuditRoadmapAnimated.astro';
import { translations, type Language, getLocalizedHref } from '../scripts/translations';

// Server-side rendered page
export const prerender = false;

const url = Astro.url;
const langParam = url.searchParams.get('lang');

// Redirect ?lang=cs to clean URL
if (langParam === 'cs') {
  const cleanUrl = new URL(Astro.url);
  cleanUrl.searchParams.delete('lang');
  const redirectPath = cleanUrl.pathname + (cleanUrl.search || '') + (cleanUrl.hash || '');
  return Astro.redirect(redirectPath || '/', 301);
}

const cookieLang = Astro.cookies.get('preferredLanguage')?.value;
const lang: Language = (langParam === 'en' || langParam === 'cs') ? langParam : 
                       (cookieLang === 'en' || cookieLang === 'cs') ? cookieLang : 'cs';
const t = translations[lang];

// Set cookie if language was explicitly selected
if (langParam && (langParam === 'en' || langParam === 'cs')) {
  Astro.cookies.set('preferredLanguage', langParam, { 
    path: '/', 
    maxAge: 60 * 60 * 24 * 365,
    sameSite: 'lax'
  });
}

const href = (path: string) => getLocalizedHref(path, lang);

// SEO
const SITE_URL = 'https://hypedigitaly.ai';

const serviceSchema = {
  "@context": "https://schema.org",
  "@type": "Service",
  "name": lang === 'cs' ? "AI Audit" : "AI Audit",
  "description": t.audit_meta_desc,
  "provider": {
    "@type": "Organization",
    "name": "HypeDigitaly s.r.o.",
    "url": SITE_URL
  },
  "url": `${SITE_URL}/audit`,
  "areaServed": { "@type": "Country", "name": "Czech Republic" },
  "serviceType": "AI Consulting",
  "offers": {
    "@type": "Offer",
    "availability": "https://schema.org/InStock",
    "price": "0",
    "priceCurrency": lang === 'cs' ? "CZK" : "USD",
    "description": lang === 'cs' ? "Bezplatný AI Pre-Audit" : "Free AI Pre-Audit"
  }
};

const breadcrumbSchema = {
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    { "@type": "ListItem", "position": 1, "name": lang === 'cs' ? "Domů" : "Home", "item": SITE_URL },
    { "@type": "ListItem", "position": 2, "name": "AI Audit", "item": `${SITE_URL}/audit` }
  ]
};

// Form options
const industryOptions = [
  { value: 'ecommerce', label: t.audit_form_industry_ecommerce },
  { value: 'healthcare', label: t.audit_form_industry_healthcare },
  { value: 'finance', label: t.audit_form_industry_finance },
  { value: 'manufacturing', label: t.audit_form_industry_manufacturing },
  { value: 'professional', label: t.audit_form_industry_professional },
  { value: 'government', label: t.audit_form_industry_government },
  { value: 'realestate', label: t.audit_form_industry_realestate },
  { value: 'other', label: t.audit_form_industry_other }
];

const employeeOptions = [
  { value: '1-10', label: '1-10' },
  { value: '11-50', label: '11-50' },
  { value: '51-200', label: '51-200' },
  { value: '201-500', label: '201-500' },
  { value: '500+', label: '500+' }
];

const revenueOptions = lang === 'cs' ? [
  { value: 'under_100k', label: 'Do 2.5 mil. Kč' },
  { value: '100k_500k', label: '2.5 - 12 mil. Kč' },
  { value: '500k_2m', label: '12 - 50 mil. Kč' },
  { value: '2m_10m', label: '50 - 250 mil. Kč' },
  { value: '10m_plus', label: '250+ mil. Kč' }
] : [
  { value: 'under_100k', label: 'Under $100K' },
  { value: '100k_500k', label: '$100K - $500K' },
  { value: '500k_2m', label: '$500K - $2M' },
  { value: '2m_10m', label: '$2M - $10M' },
  { value: '10m_plus', label: '$10M+' }
];

const painPointOptions = [
  { value: 'lead_response', label: t.audit_form_painpoint_lead_response },
  { value: 'manual_data', label: t.audit_form_painpoint_manual_data },
  { value: 'support_volume', label: t.audit_form_painpoint_support_volume },
  { value: 'repetitive_tasks', label: t.audit_form_painpoint_repetitive_tasks },
  { value: 'slow_decisions', label: t.audit_form_painpoint_slow_decisions },
  { value: 'legacy_systems', label: t.audit_form_painpoint_legacy_systems },
  { value: 'other', label: t.audit_form_painpoint_other }
];

const aiExperienceOptions = [
  { value: 'never', label: t.audit_form_ai_never },
  { value: 'failed', label: t.audit_form_ai_failed },
  { value: 'basic', label: t.audit_form_ai_basic },
  { value: 'strategy', label: t.audit_form_ai_strategy }
];
---

<PageLayout 
  title={t.audit_meta_title}
  description={t.audit_meta_desc}
  lang={lang}
  showCalendar={false}
>
  <script slot="head" type="application/ld+json" set:html={JSON.stringify(serviceSchema)} />
  <script slot="head" type="application/ld+json" set:html={JSON.stringify(breadcrumbSchema)} />

  <!-- ==================== HERO SECTION ==================== -->
  <section class="relative max-w-7xl mx-auto px-4 sm:px-6 pt-8 pb-16 overflow-hidden">
    <div class="grid grid-cols-1 lg:grid-cols-2 gap-12 items-start">
      
      <!-- Left: Hero Content -->
      <div class="relative z-10">
        <!-- Badge -->
        <div class="animate-on-scroll [animation:animationIn_0.8s_ease-out_0.1s_both] inline-flex items-center gap-2 px-4 py-2 rounded-full bg-orange-500/10 border border-orange-500/20 mb-6">
          <iconify-icon icon="solar:chart-2-bold" class="text-orange-400 text-lg"></iconify-icon>
          <span class="text-sm text-orange-400 font-medium">{t.audit_hero_badge}</span>
        </div>

        <!-- Headline -->
        <h1 class="animate-on-scroll [animation:animationIn_0.8s_ease-out_0.2s_both] leading-[1.05] md:text-5xl lg:text-6xl text-4xl font-medium text-white tracking-tighter mb-6">
          <span>{t.audit_hero_headline_1}</span><br />
          <span class="text-orange-400">{t.audit_hero_headline_2}</span>
        </h1>

        <!-- Subheadline -->
        <p class="animate-on-scroll [animation:animationIn_0.8s_ease-out_0.3s_both] text-lg text-neutral-300 font-light max-w-xl leading-relaxed mb-8">
          {t.audit_hero_subheadline}
        </p>

        <!-- Stats -->
        <div class="animate-on-scroll [animation:animationIn_0.8s_ease-out_0.4s_both] flex flex-wrap gap-6 mb-8">
          <div class="flex items-center gap-2">
            <iconify-icon icon="solar:danger-triangle-bold" class="text-red-400 text-xl"></iconify-icon>
            <span class="text-sm text-neutral-300">{t.audit_hero_stat_1}</span>
          </div>
          <div class="flex items-center gap-2">
            <iconify-icon icon="solar:wallet-money-bold" class="text-green-400 text-xl"></iconify-icon>
            <span class="text-sm text-neutral-300">{t.audit_hero_stat_2}</span>
          </div>
          <div class="flex items-center gap-2">
            <iconify-icon icon="solar:clock-circle-bold" class="text-primary text-xl"></iconify-icon>
            <span class="text-sm text-neutral-300">{t.audit_hero_stat_3}</span>
          </div>
        </div>

        <!-- Trust badges -->
        <div class="animate-on-scroll [animation:animationIn_0.8s_ease-out_0.5s_both] flex flex-wrap items-center gap-4 text-xs text-neutral-500">
          <span class="flex items-center gap-1.5">
            <iconify-icon icon="solar:shield-check-bold" class="text-primary"></iconify-icon>
            <span>{t.cta_trust_1}</span>
          </span>
          <span class="flex items-center gap-1.5">
            <iconify-icon icon="solar:lock-keyhole-bold" class="text-primary"></iconify-icon>
            <span>GDPR Compliant</span>
          </span>
          <span class="flex items-center gap-1.5">
            <iconify-icon icon="solar:verified-check-bold" class="text-primary"></iconify-icon>
            <span>{lang === 'cs' ? 'První v ČR' : 'First in CZ'}</span>
          </span>
        </div>
      </div>

      <!-- Right: Lead Capture Form -->
      <div class="animate-on-scroll [animation:animationIn_0.8s_ease-out_0.3s_both]">
        <div class="bg-[#0A0A0A] border border-white/10 rounded-2xl p-6 md:p-8 shadow-2xl" id="audit-form-container">
          
          <!-- Success State -->
          <div id="audit-success" class="hidden">
            <div class="text-center py-8">
              <div class="relative inline-flex items-center justify-center mb-6">
                <div class="absolute inset-0 animate-ping rounded-full bg-green-500/20" style="animation-duration: 1.5s;"></div>
                <div class="relative w-20 h-20 rounded-full bg-gradient-to-br from-green-500/20 to-green-500/10 border-2 border-green-500/40 flex items-center justify-center">
                  <iconify-icon icon="solar:check-circle-bold" class="text-5xl text-green-400"></iconify-icon>
                </div>
              </div>
              <h2 class="text-2xl md:text-3xl font-bold text-white mb-3">{t.audit_form_success_title}</h2>
              <p class="text-neutral-400 max-w-md mx-auto mb-6">{t.audit_form_success_desc}</p>
              <a href="https://cal.com/hypedigitaly-pavelcermak/30-min-online" target="_blank" class="inline-flex items-center gap-2 px-6 py-3 bg-primary text-white font-medium rounded-lg hover:bg-primary-light transition-colors">
                <iconify-icon icon="solar:calendar-bold" class="text-lg"></iconify-icon>
                <span>{lang === 'cs' ? 'Rezervovat konzultaci' : 'Book consultation'}</span>
              </a>
            </div>
          </div>

          <!-- Form State -->
          <div id="audit-form-state">
            <div class="mb-8">
              <h2 class="text-4xl md:text-5xl font-bold text-white mb-4 tracking-tighter" set:html={t.audit_form_title} />
              <p class="text-neutral-300 text-base leading-relaxed">{t.audit_form_desc}</p>
            </div>

            <!-- Error Message -->
            <div id="audit-error" class="hidden mb-5 p-4 bg-red-500/10 border border-red-500/30 rounded-lg">
              <div class="flex items-start gap-3">
                <iconify-icon icon="solar:danger-triangle-bold" class="text-xl text-red-400 flex-shrink-0 mt-0.5"></iconify-icon>
                <p id="audit-error-text" class="text-red-300 text-sm">{t.audit_form_error}</p>
              </div>
            </div>

            <!-- Audit Form -->
            <form id="audit-form" class="space-y-4">
              <input type="hidden" name="language" value={lang} />

              <!-- Website (Required) -->
              <div>
                <label for="website" class="block text-sm font-medium text-neutral-300 mb-1.5">
                  {t.audit_form_website}
                </label>
                <input 
                  type="url" 
                  id="website" 
                  name="website" 
                  required
                  placeholder={t.audit_form_website_placeholder}
                  class="w-full px-4 py-3 bg-neutral-900/50 border border-white/10 rounded-lg text-white placeholder-neutral-500 focus:outline-none focus:border-primary/50 focus:ring-1 focus:ring-primary/30 transition-colors"
                />
              </div>

              <!-- Email (Required) -->
              <div>
                <label for="email" class="block text-sm font-medium text-neutral-300 mb-1.5">
                  {t.audit_form_email}
                </label>
                <input 
                  type="email" 
                  id="email" 
                  name="email" 
                  required
                  placeholder={t.audit_form_email_placeholder}
                  class="w-full px-4 py-3 bg-neutral-900/50 border border-white/10 rounded-lg text-white placeholder-neutral-500 focus:outline-none focus:border-primary/50 focus:ring-1 focus:ring-primary/30 transition-colors"
                />
              </div>

              <!-- Company Name -->
              <div>
                <label for="companyName" class="block text-sm font-medium text-neutral-300 mb-1.5">
                  {t.audit_form_company}
                </label>
                <input 
                  type="text" 
                  id="companyName" 
                  name="companyName" 
                  placeholder={t.audit_form_company_placeholder}
                  class="w-full px-4 py-3 bg-neutral-900/50 border border-white/10 rounded-lg text-white placeholder-neutral-500 focus:outline-none focus:border-primary/50 focus:ring-1 focus:ring-primary/30 transition-colors"
                />
              </div>

              <!-- Industry & Employees Row -->
              <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
                <div>
                  <label for="industry" class="block text-sm font-medium text-neutral-300 mb-1.5">
                    {t.audit_form_industry}
                  </label>
                  <select 
                    id="industry" 
                    name="industry"
                    class="w-full px-4 py-3 bg-neutral-900/50 border border-white/10 rounded-lg text-white focus:outline-none focus:border-primary/50 focus:ring-1 focus:ring-primary/30 transition-colors appearance-none cursor-pointer"
                    style="background-image: url('data:image/svg+xml;charset=US-ASCII,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 24 24%22 fill=%22none%22 stroke=%22%239ca3af%22 stroke-width=%222%22><path d=%22M6 9l6 6 6-6%22/></svg>'); background-repeat: no-repeat; background-position: right 12px center; background-size: 18px;"
                  >
                    <option value="" class="bg-neutral-900">{t.audit_form_industry_placeholder}</option>
                    {industryOptions.map(opt => (
                      <option value={opt.value} class="bg-neutral-900">{opt.label}</option>
                    ))}
                  </select>
                </div>
                <div>
                  <label for="employeeCount" class="block text-sm font-medium text-neutral-300 mb-1.5">
                    {t.audit_form_employees}
                  </label>
                  <select 
                    id="employeeCount" 
                    name="employeeCount"
                    class="w-full px-4 py-3 bg-neutral-900/50 border border-white/10 rounded-lg text-white focus:outline-none focus:border-primary/50 focus:ring-1 focus:ring-primary/30 transition-colors appearance-none cursor-pointer"
                    style="background-image: url('data:image/svg+xml;charset=US-ASCII,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 24 24%22 fill=%22none%22 stroke=%22%239ca3af%22 stroke-width=%222%22><path d=%22M6 9l6 6 6-6%22/></svg>'); background-repeat: no-repeat; background-position: right 12px center; background-size: 18px;"
                  >
                    <option value="" class="bg-neutral-900">{t.audit_form_employees_placeholder}</option>
                    {employeeOptions.map(opt => (
                      <option value={opt.value} class="bg-neutral-900">{opt.label}</option>
                    ))}
                  </select>
                </div>
              </div>

              <!-- Revenue & Pain Point Row -->
              <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
                <div>
                  <label for="annualRevenue" class="block text-sm font-medium text-neutral-300 mb-1.5">
                    {t.audit_form_revenue}
                  </label>
                  <select 
                    id="annualRevenue" 
                    name="annualRevenue"
                    class="w-full px-4 py-3 bg-neutral-900/50 border border-white/10 rounded-lg text-white focus:outline-none focus:border-primary/50 focus:ring-1 focus:ring-primary/30 transition-colors appearance-none cursor-pointer"
                    style="background-image: url('data:image/svg+xml;charset=US-ASCII,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 24 24%22 fill=%22none%22 stroke=%22%239ca3af%22 stroke-width=%222%22><path d=%22M6 9l6 6 6-6%22/></svg>'); background-repeat: no-repeat; background-position: right 12px center; background-size: 18px;"
                  >
                    <option value="" class="bg-neutral-900">{t.audit_form_revenue_placeholder}</option>
                    {revenueOptions.map(opt => (
                      <option value={opt.value} class="bg-neutral-900">{opt.label}</option>
                    ))}
                  </select>
                </div>
                <div>
                  <label for="biggestPainPoint" class="block text-sm font-medium text-neutral-300 mb-1.5">
                    {t.audit_form_painpoint}
                  </label>
                  <select 
                    id="biggestPainPoint" 
                    name="biggestPainPoint"
                    class="w-full px-4 py-3 bg-neutral-900/50 border border-white/10 rounded-lg text-white focus:outline-none focus:border-primary/50 focus:ring-1 focus:ring-primary/30 transition-colors appearance-none cursor-pointer"
                    style="background-image: url('data:image/svg+xml;charset=US-ASCII,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 24 24%22 fill=%22none%22 stroke=%22%239ca3af%22 stroke-width=%222%22><path d=%22M6 9l6 6 6-6%22/></svg>'); background-repeat: no-repeat; background-position: right 12px center; background-size: 18px;"
                  >
                    <option value="" class="bg-neutral-900">{t.audit_form_painpoint_placeholder}</option>
                    {painPointOptions.map(opt => (
                      <option value={opt.value} class="bg-neutral-900">{opt.label}</option>
                    ))}
                  </select>
                </div>
              </div>

              <!-- Current Tools -->
              <div>
                <label for="currentTools" class="block text-sm font-medium text-neutral-300 mb-1.5">
                  {t.audit_form_tools}
                </label>
                <input 
                  type="text" 
                  id="currentTools" 
                  name="currentTools" 
                  placeholder={t.audit_form_tools_placeholder}
                  class="w-full px-4 py-3 bg-neutral-900/50 border border-white/10 rounded-lg text-white placeholder-neutral-500 focus:outline-none focus:border-primary/50 focus:ring-1 focus:ring-primary/30 transition-colors"
                />
              </div>

              <!-- AI Experience -->
              <div>
                <label for="previousAIAttempts" class="block text-sm font-medium text-neutral-300 mb-1.5">
                  {t.audit_form_ai_experience}
                </label>
                <select 
                  id="previousAIAttempts" 
                  name="previousAIAttempts"
                  class="w-full px-4 py-3 bg-neutral-900/50 border border-white/10 rounded-lg text-white focus:outline-none focus:border-primary/50 focus:ring-1 focus:ring-primary/30 transition-colors appearance-none cursor-pointer"
                  style="background-image: url('data:image/svg+xml;charset=US-ASCII,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 24 24%22 fill=%22none%22 stroke=%22%239ca3af%22 stroke-width=%222%22><path d=%22M6 9l6 6 6-6%22/></svg>'); background-repeat: no-repeat; background-position: right 12px center; background-size: 18px;"
                >
                  <option value="" class="bg-neutral-900">{t.audit_form_ai_experience_placeholder}</option>
                  {aiExperienceOptions.map(opt => (
                    <option value={opt.value} class="bg-neutral-900">{opt.label}</option>
                  ))}
                </select>
              </div>

              <!-- Dream Outcome -->
              <div>
                <label for="dreamOutcome" class="block text-sm font-medium text-neutral-300 mb-1.5">
                  {t.audit_form_dream}
                </label>
                <textarea 
                  id="dreamOutcome" 
                  name="dreamOutcome" 
                  rows="2"
                  placeholder={t.audit_form_dream_placeholder}
                  class="w-full px-4 py-3 bg-neutral-900/50 border border-white/10 rounded-lg text-white placeholder-neutral-500 focus:outline-none focus:border-primary/50 focus:ring-1 focus:ring-primary/30 transition-colors resize-none"
                ></textarea>
              </div>

              <!-- Submit Button -->
              <button 
                type="submit" 
                id="audit-submit-btn"
                class="w-full py-4 bg-gradient-to-r from-orange-500 to-orange-600 text-white font-semibold rounded-lg hover:from-orange-600 hover:to-orange-700 transition-all flex items-center justify-center gap-2 group disabled:opacity-50 disabled:cursor-not-allowed shadow-lg shadow-orange-500/25"
              >
                <span id="audit-btn-text">{t.audit_form_submit}</span>
                <span id="audit-btn-loading" class="hidden">{t.audit_form_submitting}</span>
                <iconify-icon icon="solar:arrow-right-linear" class="text-lg group-hover:translate-x-1 transition-transform" id="audit-btn-icon"></iconify-icon>
                <iconify-icon icon="svg-spinners:ring-resize" class="text-lg hidden" id="audit-btn-spinner"></iconify-icon>
              </button>

              <!-- Note -->
              <p class="text-xs text-neutral-500 text-center mt-3">
                {lang === 'cs' 
                  ? 'Vaše data jsou v bezpečí. Nikdy je nesdílíme s třetími stranami.'
                  : 'Your data is safe. We never share it with third parties.'}
              </p>
            </form>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- ==================== PROCESS ROADMAP (Animated Road) ==================== -->
  <AuditRoadmapAnimated lang={lang} t={t} />

  <!-- ==================== VALUE PROPOSITION ==================== -->
  <section class="py-24 bg-[#080808] border-t border-white/5">
    <div class="max-w-7xl mx-auto px-4 sm:px-6">
      <div class="text-center max-w-3xl mx-auto mb-16">
        <h2 class="animate-on-scroll [animation:animationIn_0.8s_ease-out_0.1s_both] text-3xl md:text-4xl lg:text-5xl font-medium text-white tracking-tighter mb-6">
          {t.audit_value_title}
        </h2>
        <p class="animate-on-scroll [animation:animationIn_0.8s_ease-out_0.2s_both] text-lg text-neutral-300">
          {t.audit_value_subtitle}
        </p>
      </div>

      <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
        <!-- Value 1 -->
        <div class="animate-on-scroll [animation:animationIn_0.8s_ease-out_0.3s_both] p-6 bg-[#0A0A0A] border border-white/5 rounded-2xl hover:border-primary/30 transition-all group">
          <div class="w-12 h-12 rounded-xl bg-primary/10 border border-primary/20 flex items-center justify-center mb-4 group-hover:scale-110 transition-transform">
            <iconify-icon icon="solar:map-bold" class="text-2xl text-primary"></iconify-icon>
          </div>
          <h3 class="text-lg font-bold text-white mb-2">{t.audit_value_1_title}</h3>
          <p class="text-neutral-300 text-sm leading-relaxed">{t.audit_value_1_desc}</p>
        </div>

        <!-- Value 2 -->
        <div class="animate-on-scroll [animation:animationIn_0.8s_ease-out_0.4s_both] p-6 bg-[#0A0A0A] border border-white/5 rounded-2xl hover:border-blue-500/30 transition-all group">
          <div class="w-12 h-12 rounded-xl bg-blue-500/10 border border-blue-500/20 flex items-center justify-center mb-4 group-hover:scale-110 transition-transform">
            <iconify-icon icon="solar:chart-square-bold" class="text-2xl text-blue-400"></iconify-icon>
          </div>
          <h3 class="text-lg font-bold text-white mb-2">{t.audit_value_2_title}</h3>
          <p class="text-neutral-300 text-sm leading-relaxed">{t.audit_value_2_desc}</p>
        </div>

        <!-- Value 3 -->
        <div class="animate-on-scroll [animation:animationIn_0.8s_ease-out_0.5s_both] p-6 bg-[#0A0A0A] border border-white/5 rounded-2xl hover:border-green-500/30 transition-all group">
          <div class="w-12 h-12 rounded-xl bg-green-500/10 border border-green-500/20 flex items-center justify-center mb-4 group-hover:scale-110 transition-transform">
            <iconify-icon icon="solar:calculator-bold" class="text-2xl text-green-400"></iconify-icon>
          </div>
          <h3 class="text-lg font-bold text-white mb-2">{t.audit_value_3_title}</h3>
          <p class="text-neutral-300 text-sm leading-relaxed">{t.audit_value_3_desc}</p>
        </div>

        <!-- Value 4 -->
        <div class="animate-on-scroll [animation:animationIn_0.8s_ease-out_0.6s_both] p-6 bg-[#0A0A0A] border border-white/5 rounded-2xl hover:border-purple-500/30 transition-all group">
          <div class="w-12 h-12 rounded-xl bg-purple-500/10 border border-purple-500/20 flex items-center justify-center mb-4 group-hover:scale-110 transition-transform">
            <iconify-icon icon="solar:route-bold" class="text-2xl text-purple-400"></iconify-icon>
          </div>
          <h3 class="text-lg font-bold text-white mb-2">{t.audit_value_4_title}</h3>
          <p class="text-neutral-300 text-sm leading-relaxed">{t.audit_value_4_desc}</p>
        </div>
      </div>
    </div>
  </section>

  <!-- ==================== PRICING SECTION ==================== -->
  <section class="py-24 bg-[#050505] border-t border-white/5">
    <div class="max-w-7xl mx-auto px-4 sm:px-6">
      <div class="text-center max-w-3xl mx-auto mb-16">
        <h2 class="animate-on-scroll [animation:animationIn_0.8s_ease-out_0.1s_both] text-3xl md:text-4xl lg:text-5xl font-medium text-white tracking-tighter mb-6">
          {t.audit_pricing_title}
        </h2>
        <p class="animate-on-scroll [animation:animationIn_0.8s_ease-out_0.2s_both] text-lg text-neutral-300">
          {t.audit_pricing_subtitle}
        </p>
      </div>

      <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
        <!-- Pre-Audit (Free) -->
        <div class="animate-on-scroll [animation:animationIn_0.8s_ease-out_0.3s_both] p-8 bg-[#0A0A0A] border border-white/5 rounded-2xl hover:border-white/10 transition-all relative">
          <div class="absolute -top-3 left-6 px-3 py-1 rounded-full bg-green-500/20 border border-green-500/30 text-green-400 text-xs font-bold">
            {lang === 'cs' ? 'VSTUPNÍ NABÍDKA' : 'LEAD MAGNET'}
          </div>
          <h3 class="text-2xl font-bold text-white mb-2 mt-2">{t.audit_pricing_preaudit_title}</h3>
          <div class="text-4xl font-bold text-green-400 mb-4">{t.audit_pricing_preaudit_price}</div>
          <p class="text-neutral-300 text-sm mb-6 leading-relaxed">{t.audit_pricing_preaudit_desc}</p>
          <ul class="space-y-3 mb-8">
            <li class="flex items-center gap-3 text-sm text-neutral-300">
              <iconify-icon icon="solar:check-circle-bold" class="text-green-400 text-lg"></iconify-icon>
              {t.audit_pricing_preaudit_f1}
            </li>
            <li class="flex items-center gap-3 text-sm text-neutral-300">
              <iconify-icon icon="solar:check-circle-bold" class="text-green-400 text-lg"></iconify-icon>
              {t.audit_pricing_preaudit_f2}
            </li>
            <li class="flex items-center gap-3 text-sm text-neutral-300">
              <iconify-icon icon="solar:check-circle-bold" class="text-green-400 text-lg"></iconify-icon>
              {t.audit_pricing_preaudit_f3}
            </li>
            <li class="flex items-center gap-3 text-sm text-neutral-300">
              <iconify-icon icon="solar:check-circle-bold" class="text-green-400 text-lg"></iconify-icon>
              {t.audit_pricing_preaudit_f4}
            </li>
          </ul>
          <a href="#audit-form-container" class="block w-full py-4 text-center bg-green-500/20 border border-green-500/30 text-green-400 font-semibold rounded-lg hover:bg-green-500/30 transition-all">
            {t.audit_form_submit}
          </a>
        </div>

        <!-- Quick Strike Audit -->
        <div class="animate-on-scroll [animation:animationIn_0.8s_ease-out_0.4s_both] p-8 bg-gradient-to-br from-primary/10 via-[#0A0A0A] to-[#0A0A0A] border-2 border-primary/30 rounded-2xl hover:border-primary/50 transition-all relative">
          <div class="absolute -top-3 left-1/2 -translate-x-1/2 px-4 py-1 bg-primary text-white text-xs font-bold rounded-full">
            {lang === 'cs' ? 'DOPORUČUJEME' : 'RECOMMENDED'}
          </div>
          <h3 class="text-2xl font-bold text-white mb-2 mt-2">{t.audit_pricing_quickstrike_title}</h3>
          <div class="text-3xl font-bold text-primary mb-4">{t.audit_pricing_quickstrike_price}</div>
          <p class="text-neutral-300 text-sm mb-6 leading-relaxed">{t.audit_pricing_quickstrike_desc}</p>
          <ul class="space-y-3 mb-8">
            <li class="flex items-center gap-3 text-sm text-neutral-300">
              <iconify-icon icon="solar:check-circle-bold" class="text-primary text-lg"></iconify-icon>
              {t.audit_pricing_quickstrike_f1}
            </li>
            <li class="flex items-center gap-3 text-sm text-neutral-300">
              <iconify-icon icon="solar:check-circle-bold" class="text-primary text-lg"></iconify-icon>
              {t.audit_pricing_quickstrike_f2}
            </li>
            <li class="flex items-center gap-3 text-sm text-neutral-300">
              <iconify-icon icon="solar:check-circle-bold" class="text-primary text-lg"></iconify-icon>
              {t.audit_pricing_quickstrike_f3}
            </li>
            <li class="flex items-center gap-3 text-sm text-neutral-300">
              <iconify-icon icon="solar:check-circle-bold" class="text-primary text-lg"></iconify-icon>
              {t.audit_pricing_quickstrike_f4}
            </li>
            <li class="flex items-center gap-3 text-sm text-neutral-300">
              <iconify-icon icon="solar:check-circle-bold" class="text-primary text-lg"></iconify-icon>
              {t.audit_pricing_quickstrike_f5}
            </li>
          </ul>
          <a href={href("/kontakt")} class="shiny-cta group">
            <span class="btn-content font-semibold">{lang === 'cs' ? 'Kontaktujte nás' : 'Contact us'}</span>
          </a>
        </div>

        <!-- Full Transformation Audit -->
        <div class="animate-on-scroll [animation:animationIn_0.8s_ease-out_0.5s_both] p-8 bg-[#0A0A0A] border border-white/5 rounded-2xl hover:border-white/10 transition-all relative">
          <div class="absolute -top-3 left-6 px-3 py-1 rounded-full bg-purple-500/20 border border-purple-500/30 text-purple-400 text-xs font-bold">
            {lang === 'cs' ? 'PRO VELKÉ FIRMY' : 'ENTERPRISE'}
          </div>
          <h3 class="text-2xl font-bold text-white mb-2 mt-2">{t.audit_pricing_full_title}</h3>
          <div class="text-3xl font-bold text-purple-400 mb-4">{t.audit_pricing_full_price}</div>
          <p class="text-neutral-300 text-sm mb-6 leading-relaxed">{t.audit_pricing_full_desc}</p>
          <ul class="space-y-3 mb-8">
            <li class="flex items-center gap-3 text-sm text-neutral-300">
              <iconify-icon icon="solar:check-circle-bold" class="text-purple-400 text-lg"></iconify-icon>
              {t.audit_pricing_full_f1}
            </li>
            <li class="flex items-center gap-3 text-sm text-neutral-300">
              <iconify-icon icon="solar:check-circle-bold" class="text-purple-400 text-lg"></iconify-icon>
              {t.audit_pricing_full_f2}
            </li>
            <li class="flex items-center gap-3 text-sm text-neutral-300">
              <iconify-icon icon="solar:check-circle-bold" class="text-purple-400 text-lg"></iconify-icon>
              {t.audit_pricing_full_f3}
            </li>
            <li class="flex items-center gap-3 text-sm text-neutral-300">
              <iconify-icon icon="solar:check-circle-bold" class="text-purple-400 text-lg"></iconify-icon>
              {t.audit_pricing_full_f4}
            </li>
            <li class="flex items-center gap-3 text-sm text-neutral-300">
              <iconify-icon icon="solar:check-circle-bold" class="text-purple-400 text-lg"></iconify-icon>
              {t.audit_pricing_full_f5}
            </li>
            <li class="flex items-center gap-3 text-sm text-neutral-300">
              <iconify-icon icon="solar:check-circle-bold" class="text-purple-400 text-lg"></iconify-icon>
              {t.audit_pricing_full_f6}
            </li>
          </ul>
          <a href={href("/kontakt")} class="block w-full py-4 text-center bg-purple-500/20 border border-purple-500/30 text-purple-400 font-semibold rounded-lg hover:bg-purple-500/30 transition-all">
            {lang === 'cs' ? 'Kontaktujte nás' : 'Contact us'}
          </a>
        </div>
      </div>
    </div>
  </section>

  <!-- ==================== FINAL CTA ==================== -->
  <section class="py-24 bg-gradient-to-b from-[#080808] to-[#050505] border-t border-white/5">
    <div class="max-w-4xl mx-auto px-4 sm:px-6 text-center">
      <h2 class="animate-on-scroll [animation:animationIn_0.8s_ease-out_0.1s_both] text-3xl md:text-4xl lg:text-5xl font-medium text-white tracking-tighter mb-6">
        {t.audit_cta_title}
      </h2>
      <p class="animate-on-scroll [animation:animationIn_0.8s_ease-out_0.2s_both] text-lg text-neutral-300 mb-10 max-w-2xl mx-auto">
        {t.audit_cta_desc}
      </p>
      <div class="animate-on-scroll [animation:animationIn_0.8s_ease-out_0.3s_both]">
        <a href="#audit-form-container" class="inline-flex items-center gap-3 px-8 py-4 bg-gradient-to-r from-orange-500 to-orange-600 text-white font-bold text-lg rounded-full hover:from-orange-600 hover:to-orange-700 transition-all shadow-lg shadow-orange-500/25">
          <iconify-icon icon="solar:chart-2-bold" class="text-xl"></iconify-icon>
          {t.audit_cta_button}
        </a>
      </div>
    </div>
  </section>

  <!-- Form Handler Script -->
  <script is:inline>
    (function() {
      const form = document.getElementById('audit-form');
      const submitBtn = document.getElementById('audit-submit-btn');
      const btnText = document.getElementById('audit-btn-text');
      const btnLoading = document.getElementById('audit-btn-loading');
      const btnIcon = document.getElementById('audit-btn-icon');
      const btnSpinner = document.getElementById('audit-btn-spinner');
      const formState = document.getElementById('audit-form-state');
      const successState = document.getElementById('audit-success');
      const errorMessage = document.getElementById('audit-error');
      const errorText = document.getElementById('audit-error-text');

      if (!form) return;

      function setLoading(isLoading) {
        if (isLoading) {
          btnText.classList.add('hidden');
          btnIcon.classList.add('hidden');
          btnLoading.classList.remove('hidden');
          btnSpinner.classList.remove('hidden');
          submitBtn.disabled = true;
        } else {
          btnText.classList.remove('hidden');
          btnIcon.classList.remove('hidden');
          btnLoading.classList.add('hidden');
          btnSpinner.classList.add('hidden');
          submitBtn.disabled = false;
        }
      }

      function showError(message) {
        errorText.textContent = message;
        errorMessage.classList.remove('hidden');
        errorMessage.scrollIntoView({ behavior: 'smooth', block: 'center' });
      }

      function hideError() {
        errorMessage.classList.add('hidden');
      }

      function showSuccess() {
        formState.classList.add('hidden');
        successState.classList.remove('hidden');
        document.getElementById('audit-form-container').scrollIntoView({ behavior: 'smooth', block: 'start' });
      }

      form.addEventListener('submit', async function(e) {
        e.preventDefault();
        hideError();
        setLoading(true);

        const formData = new FormData(form);
        const data = {
          email: formData.get('email'),
          website: formData.get('website'),
          companyName: formData.get('companyName') || undefined,
          industry: formData.get('industry') || undefined,
          employeeCount: formData.get('employeeCount') || undefined,
          annualRevenue: formData.get('annualRevenue') || undefined,
          biggestPainPoint: formData.get('biggestPainPoint') || undefined,
          currentTools: formData.get('currentTools') || undefined,
          previousAIAttempts: formData.get('previousAIAttempts') || undefined,
          dreamOutcome: formData.get('dreamOutcome') || undefined,
          language: formData.get('language') || 'cs'
        };

        try {
          const response = await fetch('/.netlify/functions/audit', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify(data),
          });

          const result = await response.json();

          if (response.ok && result.success) {
            showSuccess();
          } else {
            showError(result.error || 'Something went wrong. Please try again.');
          }
        } catch (error) {
          console.error('Audit form error:', error);
          showError('Failed to submit. Please check your connection and try again.');
        } finally {
          setLoading(false);
        }
      });
    })();
  </script>
</PageLayout>
